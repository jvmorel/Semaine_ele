#
#
#
#
##############################################################################################################
##  Fonctions pour le serveur WEB                                                                           ##
##############################################################################################################
#
#
#
##############################################################################################################
#...Pour envoyer la page html
##############################################################################################################
def send_web_page(conn):
  html  = """<html>  """
  html += """      <head>  """
  html += """      <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>  """
  html += """      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">  """
  html += """      <link rel="preconnect" href="https://fonts.googleapis.com">  """
  html += """      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>  """
  html += """      <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">  """
  html += """      <title>Station météo </title>  """
  html += """      <meta name="viewport" content="width=device-width, initial-scale=1">  """
  html += """      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />  """
  html += """      <meta http-equiv="refresh" content="5" >  """
  html += """      <link rel="icon" href="data:,">  """
  conn.sendall(html)

  ###############################################################
  #...Definition du style
  ###############################################################
  html  = """  """
  html += """      <style>  """
  html += """          body{  """
  html += """              background-color: rgba(232, 222, 209, 0.3);  """
  html += """              font-family: 'Lato', sans-serif;  """
  html += """              width:75%;  """
  html += """              margin: auto;  """
  html += """              text-align: center;  """
  html += """          }  """
  html += """  """
  html += """          p{  """
  html += """              font-size: 1.5rem;  """
  html += """  """
  html += """          }  """
  html += """  """
  html += """          h1, h2, h3, h4, h5, h6{  """
  html += """              font-family: 'Montserrat', sans-serif;  """
  html += """              text-transform: uppercase;  """
  html += """              letter-spacing: .3rem;  """
  html += """          }  """
  html += """  """
  html += """          h1{  """
  html += """              color: #0F3376;  """
  html += """              margin-top: 5%;  """
  html += """              font-size: 3rem;  """
  html += """          }  """
  html += """  """
  html += """          h2{  """
  html += """              font-size: 2rem;  """
  html += """          }  """
  html += """  """
  html += """          /*  """
  html += """          table{  """
  html += """          font-size: 2rem;  """
  html += """          text-align:left;  """
  html += """          }  """
  html += """          */  """
  html += """  """
  html += """          .insideBox{  """
  html += """              margin:auto;  """
  html += """              width=75%;  """
  html += """              background-color: #fff;  """
  html += """              padding:5%;  """
  html += """              margin-bottom: 5%;  """
  html += """              text-align: center;  """
  html += """          }  """
  html += """  """
  html += """          button{  """
  html += """              display: inline-block;  """
  html += """              border: none;  """
  html += """              border-radius: 4px;  """
  html += """              margin: 2px;  """
  html += """              padding: 16px 40px;  """
  html += """              font-size: 30px;  """
  html += """              color: white;  """
  html += """              cursor: pointer;  """
  html += """          }  """
  html += """  """
  html += """          .button{  """
  html += """              background-color: #e7bd3b;  """
  html += """          }  """
  html += """  """
  html += """          .button2{  """
  html += """              background-color: #4286f4;  """
  html += """          }  """
  html += """  """
  html += """          .grid-container {  """
  html += """              display: grid;  """
  html += """              grid-template-columns: 1fr 1fr;  """
  html += """              grid-gap: 1%;  """
  html += """              margin-bottom: 5%;  """
  html += """          }  """
  html += """            """
  html += """          .grid-container-3 {  """
  html += """              display: grid;  """
  html += """              grid-template-columns: 1fr 1fr 1fr;  """
  html += """              grid-gap: 1%;  """
  html += """              margin-bottom: 5%;  """
  html += """          }  """
  html += """  """
  html += """          .grid-container-4 {  """
  html += """              display: grid;  """
  html += """              grid-template-columns: 1fr 1fr 1fr 1fr;  """
  html += """              grid-gap: 1%;  """
  html += """              margin-bottom: 5%;  """
  html += """          }  """
  html += """  """
  html += """          .iconIndicator{  """
  html += """              font-size: 3rem;  """
  html += """          }  """
  html += """  """
  html += """      </style>  """
  html += """  </head>  """
  html += """  <body>  """
  html += """  """
  conn.sendall(html)
  
  ###############################################################
  #...Affichage du titre
  ###############################################################
  html  = """  """
  html += """<!--  """
  html += """<div class="outsideBox">  """
  html += """-->  """
  html += """      <h1><i class="fas fa-cloud-sun"></i> MontMétéo <i class="fas fa-cloud-rain"></i></h1>  """
  html += """      <h2>Station météo personnelle</h2>  """
  html += """  """
  conn.sendall(html)

  ###############################################################
  html  = """  """
  html += """      <div class="insideBox">  """
  html += """          <h3>Données atmosphériques</h3>  """
  html += """          <div class="grid-container-3">  """
  conn.sendall(html)

  ###############################################################
  #...Affichage de la lumiere
  ###############################################################
  html  = """  """
  html += """              <div>  """
  #... Cas 1
  if valeurs['lumiere'] == 1 : 
    html += """                  <i class="fas fa-moon iconIndicator"></i><p>Il fait nuit.</p>  """
  #... Cas 2
  else:
    html += """                  <i class="fas fa-sun iconIndicator"></i><p>Il fait jour.</p>  """
  #... fin cas
  html += """              </div>  """
  conn.sendall(html)

  ###############################################################
  #...Affichage de la sonde de température
  ###############################################################
  html  = """  """
  html += """              <div>  """
  html += """                  <p>  """
  #... Cas 1
  if valeurs['temperature'] > 30 : 
    html += """                      <i class="fas fa-thermometer-full " style="color: #DC143C;font-size: 4rem;"></i>  """
    html += """                      <br>  """
  #... Cas 2
  elif valeurs['temperature'] >20:
    html += """                      <i class="fas fa-thermometer-half" style="color: #2ECC71;font-size: 4rem;"></i>  """
    html += """                      <br>  """
  #... Cas 3
  else:
    html += """                      <i class="fas fa-thermometer-quarter" style="color: #85C1E9;font-size: 4rem;"></i>  """
    html += """                      <br>  """
  #... fin cas
  html += """                      <span style="font-size: 7rem">%d</span>  """ % (valeurs['temperature'])
  html += """                      <span style="vertical-align: top;">°C</span>  """
  html += """                  </p>  """
  html += """              </div>  """
  conn.sendall(html)

  ###############################################################
  #...Affichage de la sonde température / pression / altitude
  ###############################################################
  html  = """  """
  html += """              <div>  """
  html += """                  <h4>Sonde</h4>  """
  html += """                  <p><i class="fas fa-thermometer-half"></i><br> %d °C</p>  """%(valeurs['temperature_bmp180'])
  html += """                  <p><i class="fas fa-weight-hanging"></i><br> %d hPa</p>  """%(valeurs['pression_bmp180'])
  html += """                  <p><i class="fas fa-mountain"></i><br> %d m</p>  """%(valeurs['altitude_bmp180'])
  html += """              </div>  """
  html += """  """
  conn.sendall(html)


#  ###############################################################
#  html  = """  """
#  html += """          </div>  """
#  html += """      </div>  """
#  html += """  """
#  conn.sendall(html)
#
#  ###############################################################
#  #...Controle des led depuis la page WEB
#  ###############################################################
#  html  = """  """
#  html += """      <div class="grid-container-4">  """
#  html += """          <div class="insideBox">  """
#  html += """              <h3>LED Blanche</h3>  """
#  html += """              <p>   """
#  html += """                  <i class="fas fa-lightbulb" style="color:#FFD700;"></i>  """
#  html += """                  <br><br>  """
#  html += """                  <a href="/?led_blanche=on"><button class="button">ON</button></a>  """
#  html += """              </p>  """
#  html += """              <p>             """
#  html += """                  <i class="fas fa-lightbulb" style="color:#dcdcdc;"></i>  """
#  html += """                  <br><br>  """
#  html += """                  <a href="/?led_blanche=off"><button class="button2">OFF</button></a>  """
#  html += """              </p>  """
#  html += """          </div>  """
#  html += """          <div class="insideBox">  """
#  html += """              <h3>LED Bleue </h3>  """
#  html += """              <p>   """
#  html += """                  <i class="fas fa-lightbulb" style="color:#FFD700;"></i>  """
#  html += """                  <br><br>  """
#  html += """                  <a href="/?led_bleue=on"><button class="button">ON</button></a>  """
#  html += """              </p>  """
#  html += """              <p>             """
#  html += """                  <i class="fas fa-lightbulb" style="color:#dcdcdc;"></i>  """
#  html += """                  <br><br>  """
#  html += """                  <a href="/?led_bleue=off"><button class="button2">OFF</button></a>  """
#  html += """              </p>  """
#  html += """          </div>  """
#  html += """          <div class="insideBox">  """
#  html += """              <h3>LED Rouge </h3>  """
#  html += """              <p>   """
#  html += """                  <i class="fas fa-lightbulb" style="color:#FFD700;"></i>  """
#  html += """                  <br><br>  """
#  html += """                  <a href="/?led_rouge=on"><button class="button">ON</button></a>  """
#  html += """              </p>  """
#  html += """              <p>             """
#  html += """                  <i class="fas fa-lightbulb" style="color:#dcdcdc;"></i>  """
#  html += """                  <br><br>  """
#  html += """                  <a href="/?led_rouge=off"><button class="button2">OFF</button></a>  """
#  html += """              </p>  """
#  html += """          </div>  """
#  conn.sendall(html)
#
#  ###############################################################
#  #...Controle du buzzer depuis la page WEB
#  ###############################################################
#  html  = """  """
#  html += """          <div class="insideBox">  """
#  html += """              <p>  """
#  html += """              <h3>Buzzer </h3>  """
#  html += """              <p>  """
#  html += """                  <i class="fas fa-bullhorn" style="color:#FF6347;"></i>  """
#  html += """                  <br><br>  """
#  html += """                  <a href="/?buz=on"><button class="button">ON</button></a>  """
#  html += """              </p>  """
#  html += """              <p>  """
#  html += """                  <i class="fas fa-bullhorn" style="color:#dcdcdc;"></i>  """
#  html += """                  <br><br>  """
#  html += """                  <a href="/?buz=off"><button class="button2">OFF</button></a>  """
#  html += """              </p>  """
#  html += """          </div>  """
#  conn.sendall(html)
#
#  ###############################################################
#  html  = """  """
#  html += """      </div>  """
#  html += """  """
#  conn.sendall(html)
  

  ###############################################################
  #...Affichage du capteur d'obstacle
  ###############################################################
  html  = """  """
  html += """      <div class="insideBox">  """
  html += """          <h3>Détection</h3>  """
  html += """          <div class="grid-container-3">  """
  html += """              <div>  """
  #... Cas 1
  if  valeurs['obstacle'] == 0 : 
    html += """                  <i class="fas fa-exclamation iconIndicator"></i>   """
    html += """                  <p>Quelque chose est situé devant le détecteur.</p>  """
  #... Cas 2
  else:
    html += """                  <i class="fas fa-times iconIndicator"></i>  """
    html += """                  <p>Il n'y a rien devant le détecteur.</p>  """
  #... fin cas
  html += """  """
  html += """              </div>  """
  conn.sendall(html)
  
  ###############################################################
  #...Affichage de l'état du bouton
  ###############################################################
  html  = """  """
  html += """              <div>  """
  #... Cas 1
  if valeurs['bouton'] == 1: 
    html += """                  <i class="fas fa-exclamation iconIndicator"></i>   """
    html += """                  <p>Le bouton est appuyé.</p>  """
  #... Cas 2
  else:
    html += """                  <i class="fas fa-times iconIndicator"></i>  """
    html += """                  <p>Le bouton n'est pas appuyé.</p>  """
  #... fin cas
  html += """  """
  html += """              </div>  """
  conn.sendall(html)

  ###############################################################
  #...Affichage du détecteur de mouvement
  ###############################################################
  html  = """  """
  html += """              <div>  """
  #... Cas 1
  if valeurs['mouvement'] == 1: 
    html += """                  <i class="fas fa-exclamation iconIndicator"></i>   """
    html += """                  <p>Mouvement détecté.</p>  """
  #... Cas 2
  else:
    html += """                  <i class="fas fa-times iconIndicator"></i>  """
    html += """                  <p>Il n'y a pas de mouvement.</p>  """
  #... fin cas
  html += """  """
  html += """              </div>  """
  conn.sendall(html)

  ###############################################################
  #...fin
  ###############################################################
  html  = """  """
  html += """          </div>  """
  html += """      </div>  """
  html += """  """
  html += """  </body>  """
  html += """</html>  """
  html += """  """
  conn.sendall(html)
  return
